M = $(shell printf "\033[34;1mâ–¶\033[0m")
Q = $(if $(filter 1,$V),,@)

BUILDER:=./builder

THEME:=schemes/onedark.yaml

all: ghostty alacritty k9s tmux fzf regolith new-tab

.PHONY: ghostty
ghostty:
	$(Q) mkdir -p ../ghostty/themes
	$(Q) IN=templates/ghostty OUT=../ghostty/themes/theme $(MAKE) --no-print-directory _render

.PHONY: alacritty
alacritty:
	$(Q) IN=templates/alacritty.toml OUT=../alacritty/theme.toml $(MAKE) --no-print-directory _render

.PHONY: k9s
k9s:
	$(Q) IN=templates/k9s.yaml OUT=../k9s/skins/theme.yaml $(MAKE) --no-print-directory _render

.PHONY: tmux
tmux:
	$(Q) IN=templates/tmux.tmux OUT=../tmux/colors.tmux $(MAKE) --no-print-directory _render

.PHONY: fzf
fzf:
	$(Q) IN=templates/fzf.fish OUT=../fish/conf.d/fzf-theme.fish $(MAKE) --no-print-directory _render

.PHONY: regolith
regolith:
	$(Q) IN=templates/regolith OUT=../regolith3/Xresources $(MAKE) --no-print-directory _render

.PHONY: new-tab
new-tab:
	$(Q) IN=templates/new-tab.html OUT=../../new-tab.html $(MAKE) --no-print-directory _render

.PHONY: _render
_render:
	$(info $(M) Rendering $(IN) to $(OUT))
	$(Q) $(BUILDER) -t $(IN) -c $(THEME) > $(OUT)
