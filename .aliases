#!/bin/bash

# Delete entry from history
alias historyrm='HID=$(history | fzf | awk "{print $1}") && history -d $HID'

# Set better defaults for common ops
alias cp="cp -i"          # Confirm before overwriting something
alias mv='mv -i'		  # Confirm before overwriting something
alias sudo='sudo '        # Enable aliases to be sudoâ€™ed
alias df='df -h'          # human-readable sizes
alias du='du -h'          # human-readable sizes
alias free='free -m'      # show sizes in MB

# IP addresses
alias ippub="wget http://ipinfo.io/ip -qO -"
alias iplocal="ip addr | grep -Eo 'inet (addr:)?([0-9]*\.){3}[0-9]*' | grep -Eo '([0-9]*\.){3}[0-9]*' | grep -v '127.0.0.1'"
alias ips="ip addr | grep -o 'inet6\? \(addr:\)\?\s\?\(\(\([0-9]\+\.\)\{3\}[0-9]\+\)\|[a-fA-F0-9:]\+\)' | awk '{ sub(/inet6? (addr:)? ?/, \"\"); print }'"

# httpie
for method in get post put delete; do
	alias "$method"="xh '$method'"
done

# docker aliases
alias drma='docker rm `docker ps -aq --filter status=exited --filter status=created`' # remove all docker containers
alias drmi='docker rmi -f $(docker images -f "dangling=true" -q)'                     # remove all untagged images
alias drmv='docker volume rm $(docker volume ls -f dangling=true -q)'                 # remove dangling volumes
alias dstp='docker stop `docker ps -q`'                                               # stop all containers
alias dcln='dstp; drma; drmi; drmv'                                                   # do all of the above

# kubectl aliases
alias k='kubectl'
complete -F __start_kubectl k

# git aliases
alias gitlog='git log --graph --pretty=oneline --abbrev-commit --all'

# use bat not cat
if command -v batcat &> /dev/null ; then
	alias cat='batcat -pp'
fi

# Use exa not ls
if command -v exa &> /dev/null ; then
	alias ls='exa'
	alias l="exa -lF -s type"   # List all files colorized in long format
	alias la="exa -alF -s type" # List all files colorized in long format, including dot files
	alias ll="exa -alF -s type"
fi

# python http server
alias serve='python3 -m http.server'

# Extract jwt header/payload
alias jwth="tr '.' '\t' | awk '{print \$1}' | base64 -d 2>/dev/null | jq"
alias jwtp="tr '.' '\t' | awk '{print \$2}' | base64 -d 2>/dev/null | jq"

# Github
alias ghpr='gh pr create --assignee gbbirkisson --draft'

# Poetry
alias venv_refresh='rm -r .venv && poetry install'
# alias poetry_fix='find ~/.cache/pypoetry/ -name '*.lock' -delete'
alias poetry_fix='poetry cache clear --all . && rm -rf $(poetry config cache-dir)/artifacts'
# alias poetry_fix='poetry cache clear --all pypi'

# Songs listened to. This assumes the 'Notifications Logger' gnome extension
# Example usage: songs | awk -F'|' '{print $3 " @ " $4}' | sort | uniq | wc -l
alias songs='grep -R "Shown|Low" ~/.notifications/ | sed "s%/home/gbbirkisson/.notifications/%%g" | sed "s%.log:%|%g" | sed "s%Shown|Low|%%g"'

# Wal
alias wal='/home/gbbirkisson/Documents/repos/personal/TorWAL/wal/wal.py'

# Oda
alias klipy="/home/gbbirkisson/repos/oda/klipy/.venv/bin/python -m klipy"
alias velo="/home/gbbirkisson/repos/oda/velo/.venv/bin/python /home/gbbirkisson/repos/oda/velo/velo/cli/main.py"
alias mat='echo -e "\e[0;31mMat NY24:\033[0m" && curl -s https://www.ny24.no/api/fetch/$(date "+%u") | jq -r ".menu.no[]" | nl -s ": " -w 1'

# Vim
alias vim="nvim"
alias v="poetry run nvim . || nvim ."
alias :q="exit"
alias vimcheat="xdg-open https://www.gbb.is/posts/2022-09-28-vim-cheatsheet/"

# Code
alias c="code . && exit"

# Git
alias gc="git commit -m"
alias gcb="git checkout -b"
alias gp="git pull"
alias gps="git push"
alias gs="git status"
alias ga="git add"
alias gd="git diff"

# Docker compose
alias dcup="docker compose up -d"
alias dcstop="docker compose stop"
